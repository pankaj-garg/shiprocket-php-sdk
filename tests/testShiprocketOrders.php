<?php

/**
 * Class TestShiprocketOrders
 */
class TestShiprocketOrders extends \PHPUnit_Framework_TestCase
{
	public function test_get_order_returns_valid_order_object()
	{
		$orderJSON    = '{"data":{"id":5091,"channel_id":29,"channel_name":"MANUAL","base_channel_code":"CS","channel_order_id":"29837231111","customer_name":"Rajat Hans","customer_email":"mail@gt.com","customer_phone":"0873786395","customer_address":"6055\/5 Vasant Kunj","customer_address_2":"","customer_city":"New Delhi","customer_state":"Delhi","customer_pincode":110070,"customer_country":"India","country_code":99,"state_code":1483,"payment_status":"","pickup_code":"400090","delivery_code":110070,"total":"314.00","net_total":"1199.00","other_charges":"0.00","other_discounts":"0.00","giftwrap_charges":"0.00","expedited":0,"sla":"2 days","cod":1,"discount":"955.00","tax":"0.00","status":"NEW","status_code":1,"payment_method":"cod","channel_created_at":"23 May 2017 04:11 PM","created_at":"23 May 2017 04:12 PM","order_date":"23 May 2017","updated_at":"23 May 2017 04:12 PM","products":[{"id":5538,"order_id":5091,"name":"JJJ","sku":"DDD","channel_order_product_id":"10850","channel_sku":"DDD","model":null,"manufacturer":null,"brand":null,"color":null,"size":null,"custom_field":"","custom_field_value":"","custom_field_value_string":"","weight":0,"dimensions":"0x0x0","price":"1199.00","cost":"0.00","mrp":"0.00","quantity":1,"tax":0,"status":1,"net_total":"1199.00","discount":"0.00"}],"shipments":{"id":5080,"order_id":5091,"order_product_id":null,"channel_id":29,"code":"","cost":"70.00","awb":null,"cod_charges":"0.00","number":null,"name":null,"order_item_id":null,"weight":"0.5","volumetric_weight":"0.4","dimensions":"20x10x10","comment":"","courier":"","manifest_id":"","status":"PENDING","created_at":"23rd May 2017 04:12 PM","updated_at":"26th May 2017 04:40 PM"},"awb_data":{"awb":"","applied_weight":"","charged_weight":"","billed_weight":""}}}{"id":5091,"channel_id":29,"channel_name":"MANUAL","base_channel_code":"CS","channel_order_id":"29837231111","customer_name":"Rajat Hans","customer_email":"mail@gt.com","customer_phone":"0873786395","customer_address":"6055\/5 Vasant Kunj","customer_address_2":"","customer_city":"New Delhi","customer_state":"Delhi","customer_pincode":110070,"customer_country":"India","country_code":99,"state_code":1483,"payment_status":"","pickup_code":"400090","delivery_code":110070,"total":"314.00","net_total":"1199.00","other_charges":"0.00","other_discounts":"0.00","giftwrap_charges":"0.00","expedited":0,"sla":"2 days","cod":1,"discount":"955.00","tax":"0.00","status":"NEW","status_code":1,"payment_method":"cod","channel_created_at":"23 May 2017 04:11 PM","created_at":"23 May 2017 04:12 PM","order_date":"23 May 2017","updated_at":"23 May 2017 04:12 PM","products":[{"id":5538,"order_id":5091,"name":"JJJ","sku":"DDD","channel_order_product_id":"10850","channel_sku":"DDD","model":null,"manufacturer":null,"brand":null,"color":null,"size":null,"custom_field":"","custom_field_value":"","custom_field_value_string":"","weight":0,"dimensions":"0x0x0","price":"1199.00","cost":"0.00","mrp":"0.00","quantity":1,"tax":0,"status":1,"net_total":"1199.00","discount":"0.00"}],"shipments":{"id":5080,"order_id":5091,"order_product_id":null,"channel_id":29,"code":"","cost":"70.00","awb":null,"cod_charges":"0.00","number":null,"name":null,"order_item_id":null,"weight":"0.5","volumetric_weight":"0.4","dimensions":"20x10x10","comment":"","courier":"","manifest_id":"","status":"PENDING","created_at":"23rd May 2017 04:12 PM","updated_at":"26th May 2017 04:40 PM"},"awb_data":{"awb":"","applied_weight":"","charged_weight":"","billed_weight":""}}';
		$orderArray   = json_decode($orderJSON, true);
		$MockProvider = new Shiprocket\Provider\Mock(['get.orders/show/' . $orderArray['data']['id'] => $orderArray]);

		$OrderObject = (new \Shiprocket\ShiprocketOrders($MockProvider))->get($orderArray['data']['id']);

		$this->assertEquals($orderArray['id'], $OrderObject->id);
	}
}